import asyncio
from concurrent.futures import ThreadPoolExecutor
from datetime import datetime
from itertools import product

from selenium_parser import get_flights


# async def get_flights_list():
#     flights1 = await get_flights(datetime.now(), datetime(2024, 12, 31),
#                                  ['польща'],
#                                  ['рим-італія', 'мілан-італія', 'ріміні-італія'],
#                                  20, 'usd')
#     flights2 = await get_flights(datetime.now(), datetime(2024, 12, 31),
#                                  ['рим-італія', 'мілан-італія', 'ріміні-італія'],
#                                  ['барселона-іспанія', 'мадрид-іспанія'],
#                                  20, 'usd')
#     flights3 = await get_flights(datetime.now(), datetime(2024, 12, 31),
#                                  ['барселона-іспанія', 'мадрид-іспанія'],
#                                  ['варшава-польща', 'краків-польща', 'лодзь-польща'],
#                                  20, 'usd')
#     return flights1, flights2, flights3


def get_flights_list(flight_params_list):
    # Використовуємо ThreadPoolExecutor для багатопотокового пошуку рейсів
    with ThreadPoolExecutor(max_workers=10) as executor:
        results = list(executor.map(lambda params: get_flights(*params), flight_params_list))
    return results


# def get_flights_list():
#     flights1 = [{'departure_station_code': 'KRK', 'departure_id': 'Station:airport:KRK', 'departure_city_name': 'Краків', 'departure_city_id': 'City:krakow_pl', 'departure_name': 'Міжнародний аеропорт Краків - Баліце ім. Іоана Павла ІІ', 'departure_country_code': 'PL', 'departure_country_id': 'Country:PL', 'arrival_station_code': 'BGY', 'arrival_id': 'Station:airport:BGY', 'arrival_city_name': 'Мілан', 'arrival_city_id': 'City:milan_it', 'arrival_name': 'Milan Bergamo International Airport', 'arrival_country_code': 'IT', 'arrival_country_id': 'Country:IT', 'airline': 'Ryanair', 'departure_local_time': datetime(2024, 10, 23, 13, 50), 'departure_utc_time': datetime(2024, 10, 23, 11, 50), 'arrival_local_time': datetime(2024, 10, 23, 15, 35), 'arrival_utc_time': datetime(2024, 10, 23, 13, 35), 'price': 16.846, 'price_eur': 15.19, 'seats_left': 4}, {'departure_station_code': 'KRK', 'departure_id': 'Station:airport:KRK', 'departure_city_name': 'Краків', 'departure_city_id': 'City:krakow_pl', 'departure_name': 'Міжнародний аеропорт Краків - Баліце ім. Іоана Павла ІІ', 'departure_country_code': 'PL', 'departure_country_id': 'Country:PL', 'arrival_station_code': 'BGY', 'arrival_id': 'Station:airport:BGY', 'arrival_city_name': 'Мілан', 'arrival_city_id': 'City:milan_it', 'arrival_name': 'Milan Bergamo International Airport', 'arrival_country_code': 'IT', 'arrival_country_id': 'Country:IT', 'airline': 'Ryanair', 'departure_local_time': datetime(2024, 10, 2, 15, 20), 'departure_utc_time': datetime(2024, 10, 2, 13, 20), 'arrival_local_time': datetime(2024, 10, 2, 17, 5), 'arrival_utc_time': datetime(2024, 10, 2, 15, 5), 'price': 16.846, 'price_eur': 15.19, 'seats_left': 5}, {'departure_station_code': 'KRK', 'departure_id': 'Station:airport:KRK', 'departure_city_name': 'Краків', 'departure_city_id': 'City:krakow_pl', 'departure_name': 'Міжнародний аеропорт Краків - Баліце ім. Іоана Павла ІІ', 'departure_country_code': 'PL', 'departure_country_id': 'Country:PL', 'arrival_station_code': 'BGY', 'arrival_id': 'Station:airport:BGY', 'arrival_city_name': 'Мілан', 'arrival_city_id': 'City:milan_it', 'arrival_name': 'Milan Bergamo International Airport', 'arrival_country_code': 'IT', 'arrival_country_id': 'Country:IT', 'airline': 'Ryanair', 'departure_local_time': datetime(2024, 10, 28, 13, 45), 'departure_utc_time': datetime(2024, 10, 28, 12, 45), 'arrival_local_time': datetime(2024, 10, 28, 15, 35), 'arrival_utc_time': datetime(2024, 10, 28, 14, 35), 'price': 16.846, 'price_eur': 15.19, 'seats_left': 5}, {'departure_station_code': 'KRK', 'departure_id': 'Station:airport:KRK', 'departure_city_name': 'Краків', 'departure_city_id': 'City:krakow_pl', 'departure_name': 'Міжнародний аеропорт Краків - Баліце ім. Іоана Павла ІІ', 'departure_country_code': 'PL', 'departure_country_id': 'Country:PL', 'arrival_station_code': 'BGY', 'arrival_id': 'Station:airport:BGY', 'arrival_city_name': 'Мілан', 'arrival_city_id': 'City:milan_it', 'arrival_name': 'Milan Bergamo International Airport', 'arrival_country_code': 'IT', 'arrival_country_id': 'Country:IT', 'airline': 'Ryanair', 'departure_local_time': datetime(2024, 10, 28, 6, 15), 'departure_utc_time': datetime(2024, 10, 28, 5, 15), 'arrival_local_time': datetime(2024, 10, 28, 8, 5), 'arrival_utc_time': datetime(2024, 10, 28, 7, 5), 'price': 16.846, 'price_eur': 15.19, 'seats_left': 4}, {'departure_station_code': 'POZ', 'departure_id': 'Station:airport:POZ', 'departure_city_name': 'Познань', 'departure_city_id': 'City:poznan_pl', 'departure_name': 'Познань-Лавіца', 'departure_country_code': 'PL', 'departure_country_id': 'Country:PL', 'arrival_station_code': 'BGY', 'arrival_id': 'Station:airport:BGY', 'arrival_city_name': 'Мілан', 'arrival_city_id': 'City:milan_it', 'arrival_name': 'Milan Bergamo International Airport', 'arrival_country_code': 'IT', 'arrival_country_id': 'Country:IT', 'airline': 'Ryanair', 'departure_local_time': datetime(2024, 10, 9, 20, 35), 'departure_utc_time': datetime(2024, 10, 9, 18, 35), 'arrival_local_time': datetime(2024, 10, 9, 22, 25), 'arrival_utc_time': datetime(2024, 10, 9, 20, 25), 'price': 16.846, 'price_eur': 15.19, 'seats_left': None}, {'departure_station_code': 'KRK', 'departure_id': 'Station:airport:KRK', 'departure_city_name': 'Краків', 'departure_city_id': 'City:krakow_pl', 'departure_name': 'Міжнародний аеропорт Краків - Баліце ім. Іоана Павла ІІ', 'departure_country_code': 'PL', 'departure_country_id': 'Country:PL', 'arrival_station_code': 'BGY', 'arrival_id': 'Station:airport:BGY', 'arrival_city_name': 'Мілан', 'arrival_city_id': 'City:milan_it', 'arrival_name': 'Milan Bergamo International Airport', 'arrival_country_code': 'IT', 'arrival_country_id': 'Country:IT', 'airline': 'Ryanair', 'departure_local_time': datetime(2024, 10, 29, 19, 40), 'departure_utc_time': datetime(2024, 10, 29, 18, 40), 'arrival_local_time': datetime(2024, 10, 29, 21, 30), 'arrival_utc_time': datetime(2024, 10, 29, 20, 30), 'price': 16.846, 'price_eur': 15.19, 'seats_left': 5}, {'departure_station_code': 'WRO', 'departure_id': 'Station:airport:WRO', 'departure_city_name': 'Вроцлав', 'departure_city_id': 'City:wroclaw_pl', 'departure_name': 'Вроцлавський аеропорт ім. М. Коперника', 'departure_country_code': 'PL', 'departure_country_id': 'Country:PL', 'arrival_station_code': 'BGY', 'arrival_id': 'Station:airport:BGY', 'arrival_city_name': 'Мілан', 'arrival_city_id': 'City:milan_it', 'arrival_name': 'Milan Bergamo International Airport', 'arrival_country_code': 'IT', 'arrival_country_id': 'Country:IT', 'airline': 'Ryanair', 'departure_local_time': datetime(2024, 9, 28, 17, 45), 'departure_utc_time': datetime(2024, 9, 28, 15, 45), 'arrival_local_time': datetime(2024, 9, 28, 19, 25), 'arrival_utc_time': datetime(2024, 9, 28, 17, 25), 'price': 17.8552, 'price_eur': 16.1, 'seats_left': None}, {'departure_station_code': 'WRO', 'departure_id': 'Station:airport:WRO', 'departure_city_name': 'Вроцлав', 'departure_city_id': 'City:wroclaw_pl', 'departure_name': 'Вроцлавський аеропорт ім. М. Коперника', 'departure_country_code': 'PL', 'departure_country_id': 'Country:PL', 'arrival_station_code': 'BGY', 'arrival_id': 'Station:airport:BGY', 'arrival_city_name': 'Мілан', 'arrival_city_id': 'City:milan_it', 'arrival_name': 'Milan Bergamo International Airport', 'arrival_country_code': 'IT', 'arrival_country_id': 'Country:IT', 'airline': 'Ryanair', 'departure_local_time': datetime(2024, 9, 18, 20, 45), 'departure_utc_time': datetime(2024, 9, 18, 18, 45), 'arrival_local_time': datetime(2024, 9, 18, 22, 25), 'arrival_utc_time': datetime(2024, 9, 18, 20, 25), 'price': 17.8552, 'price_eur': 16.1, 'seats_left': None}, {'departure_station_code': 'KRK', 'departure_id': 'Station:airport:KRK', 'departure_city_name': 'Краків', 'departure_city_id': 'City:krakow_pl', 'departure_name': 'Міжнародний аеропорт Краків - Баліце ім. Іоана Павла ІІ', 'departure_country_code': 'PL', 'departure_country_id': 'Country:PL', 'arrival_station_code': 'MXP', 'arrival_id': 'Station:airport:MXP', 'arrival_city_name': 'Мілан', 'arrival_city_id': 'City:milan_it', 'arrival_name': 'Аеропорт Мілан Мальпенса', 'arrival_country_code': 'IT', 'arrival_country_id': 'Country:IT', 'airline': 'Ryanair', 'departure_local_time': datetime(2024, 10, 28, 8, 5), 'departure_utc_time': datetime(2024, 10, 28, 7, 5), 'arrival_local_time': datetime(2024, 10, 28, 10, 0), 'arrival_utc_time': datetime(2024, 10, 28, 9, 0), 'price': 17.8552, 'price_eur': 16.1, 'seats_left': None}, {'departure_station_code': 'POZ', 'departure_id': 'Station:airport:POZ', 'departure_city_name': 'Познань', 'departure_city_id': 'City:poznan_pl', 'departure_name': 'Познань-Лавіца', 'departure_country_code': 'PL', 'departure_country_id': 'Country:PL', 'arrival_station_code': 'BGY', 'arrival_id': 'Station:airport:BGY', 'arrival_city_name': 'Мілан', 'arrival_city_id': 'City:milan_it', 'arrival_name': 'Milan Bergamo International Airport', 'arrival_country_code': 'IT', 'arrival_country_id': 'Country:IT', 'airline': 'Ryanair', 'departure_local_time': datetime(2024, 10, 25, 20, 55), 'departure_utc_time': datetime(2024, 10, 25, 18, 55), 'arrival_local_time': datetime(2024, 10, 25, 22, 45), 'arrival_utc_time': datetime(2024, 10, 25, 20, 45), 'price': 17.955, 'price_eur': 16.19, 'seats_left': None}, {'departure_station_code': 'POZ', 'departure_id': 'Station:airport:POZ', 'departure_city_name': 'Познань', 'departure_city_id': 'City:poznan_pl', 'departure_name': 'Познань-Лавіца', 'departure_country_code': 'PL', 'departure_country_id': 'Country:PL', 'arrival_station_code': 'BGY', 'arrival_id': 'Station:airport:BGY', 'arrival_city_name': 'Мілан', 'arrival_city_id': 'City:milan_it', 'arrival_name': 'Milan Bergamo International Airport', 'arrival_country_code': 'IT', 'arrival_country_id': 'Country:IT', 'airline': 'Ryanair', 'departure_local_time': datetime(2024, 10, 8, 6, 30), 'departure_utc_time': datetime(2024, 10, 8, 4, 30), 'arrival_local_time': datetime(2024, 10, 8, 8, 20), 'arrival_utc_time': datetime(2024, 10, 8, 6, 20), 'price': 18.8089, 'price_eur': 16.96, 'seats_left': 5}, {'departure_station_code': 'GDN', 'departure_id': 'Station:airport:GDN', 'departure_city_name': 'Гданськ', 'departure_city_id': 'City:gdansk_pl', 'departure_name': 'Гданський аеропорт імені Леха Валенси', 'departure_country_code': 'PL', 'departure_country_id': 'Country:PL', 'arrival_station_code': 'BGY', 'arrival_id': 'Station:airport:BGY', 'arrival_city_name': 'Мілан', 'arrival_city_id': 'City:milan_it', 'arrival_name': 'Milan Bergamo International Airport', 'arrival_country_code': 'IT', 'arrival_country_id': 'Country:IT', 'airline': 'Ryanair', 'departure_local_time': datetime(2024, 10, 16, 18, 20), 'departure_utc_time': datetime(2024, 10, 16, 16, 20), 'arrival_local_time': datetime(2024, 10, 16, 20, 25), 'arrival_utc_time': datetime(2024, 10, 16, 18, 25), 'price': 18.8089, 'price_eur': 16.96, 'seats_left': 4}, {'departure_station_code': 'KRK', 'departure_id': 'Station:airport:KRK', 'departure_city_name': 'Краків', 'departure_city_id': 'City:krakow_pl', 'departure_name': 'Міжнародний аеропорт Краків - Баліце ім. Іоана Павла ІІ', 'departure_country_code': 'PL', 'departure_country_id': 'Country:PL', 'arrival_station_code': 'BGY', 'arrival_id': 'Station:airport:BGY', 'arrival_city_name': 'Мілан', 'arrival_city_id': 'City:milan_it', 'arrival_name': 'Milan Bergamo International Airport', 'arrival_country_code': 'IT', 'arrival_country_id': 'Country:IT', 'airline': 'Ryanair', 'departure_local_time': datetime(2024, 10, 8, 16, 20), 'departure_utc_time': datetime(2024, 10, 8, 14, 20), 'arrival_local_time': datetime(2024, 10, 8, 18, 5), 'arrival_utc_time': datetime(2024, 10, 8, 16, 5), 'price': 19.064, 'price_eur': 17.19, 'seats_left': 4}, {'departure_station_code': 'KTW', 'departure_id': 'Station:airport:KTW', 'departure_city_name': 'Катовіце', 'departure_city_id': 'City:katowice_pl', 'departure_name': 'Міжнародний аеропорт Катовіце-Пижовіце', 'departure_country_code': 'PL', 'departure_country_id': 'Country:PL', 'arrival_station_code': 'BGY', 'arrival_id': 'Station:airport:BGY', 'arrival_city_name': 'Мілан', 'arrival_city_id': 'City:milan_it', 'arrival_name': 'Milan Bergamo International Airport', 'arrival_country_code': 'IT', 'arrival_country_id': 'Country:IT', 'airline': 'Ryanair', 'departure_local_time': datetime(2024, 10, 30, 19, 15), 'departure_utc_time': datetime(2024, 10, 30, 18, 15), 'arrival_local_time': datetime(2024, 10, 30, 21, 5), 'arrival_utc_time': datetime(2024, 10, 30, 20, 5), 'price': 19.2636, 'price_eur': 17.37, 'seats_left': None}, {'departure_station_code': 'LCJ', 'departure_id': 'Station:airport:LCJ', 'departure_city_name': 'Лодзь', 'departure_city_id': 'City:lodz_pl', 'departure_name': 'Лодзь-Люблінек', 'departure_country_code': 'PL', 'departure_country_id': 'Country:PL', 'arrival_station_code': 'BGY', 'arrival_id': 'Station:airport:BGY', 'arrival_city_name': 'Мілан', 'arrival_city_id': 'City:milan_it', 'arrival_name': 'Milan Bergamo International Airport', 'arrival_country_code': 'IT', 'arrival_country_id': 'Country:IT', 'airline': 'Ryanair', 'departure_local_time': datetime(2024, 10, 16, 17, 55), 'departure_utc_time': datetime(2024, 10, 16, 15, 55), 'arrival_local_time': datetime(2024, 10, 16, 19, 45), 'arrival_utc_time': datetime(2024, 10, 16, 17, 45), 'price': 19.9068, 'price_eur': 17.95, 'seats_left': 2}, {'departure_station_code': 'KTW', 'departure_id': 'Station:airport:KTW', 'departure_city_name': 'Катовіце', 'departure_city_id': 'City:katowice_pl', 'departure_name': 'Міжнародний аеропорт Катовіце-Пижовіце', 'departure_country_code': 'PL', 'departure_country_id': 'Country:PL', 'arrival_station_code': 'BGY', 'arrival_id': 'Station:airport:BGY', 'arrival_city_name': 'Мілан', 'arrival_city_id': 'City:milan_it', 'arrival_name': 'Milan Bergamo International Airport', 'arrival_country_code': 'IT', 'arrival_country_id': 'Country:IT', 'airline': 'Ryanair', 'departure_local_time': datetime(2024, 12, 16, 12, 40), 'departure_utc_time': datetime(2024, 12, 16, 11, 40), 'arrival_local_time': datetime(2024, 12, 16, 14, 30), 'arrival_utc_time': datetime(2024, 12, 16, 13, 30), 'price': 20.3283, 'price_eur': 18.33, 'seats_left': None}, {'departure_station_code': 'WRO', 'departure_id': 'Station:airport:WRO', 'departure_city_name': 'Вроцлав', 'departure_city_id': 'City:wroclaw_pl', 'departure_name': 'Вроцлавський аеропорт ім. М. Коперника', 'departure_country_code': 'PL', 'departure_country_id': 'Country:PL', 'arrival_station_code': 'BGY', 'arrival_id': 'Station:airport:BGY', 'arrival_city_name': 'Мілан', 'arrival_city_id': 'City:milan_it', 'arrival_name': 'Milan Bergamo International Airport', 'arrival_country_code': 'IT', 'arrival_country_id': 'Country:IT', 'airline': 'Ryanair', 'departure_local_time': datetime(2024, 10, 28, 20, 10), 'departure_utc_time': datetime(2024, 10, 28, 19, 10), 'arrival_local_time': datetime(2024, 10, 28, 21, 50), 'arrival_utc_time': datetime(2024, 10, 28, 20, 50), 'price': 20.4392, 'price_eur': 18.43, 'seats_left': None}, {'departure_station_code': 'WRO', 'departure_id': 'Station:airport:WRO', 'departure_city_name': 'Вроцлав', 'departure_city_id': 'City:wroclaw_pl', 'departure_name': 'Вроцлавський аеропорт ім. М. Коперника', 'departure_country_code': 'PL', 'departure_country_id': 'Country:PL', 'arrival_station_code': 'BGY', 'arrival_id': 'Station:airport:BGY', 'arrival_city_name': 'Мілан', 'arrival_city_id': 'City:milan_it', 'arrival_name': 'Milan Bergamo International Airport', 'arrival_country_code': 'IT', 'arrival_country_id': 'Country:IT', 'airline': 'Ryanair', 'departure_local_time': datetime(2024, 10, 29, 11, 25), 'departure_utc_time': datetime(2024, 10, 29, 10, 25), 'arrival_local_time': datetime(2024, 10, 29, 13, 5), 'arrival_utc_time': datetime(2024, 10, 29, 12, 5), 'price': 20.4392, 'price_eur': 18.43, 'seats_left': None}, {'departure_station_code': 'WRO', 'departure_id': 'Station:airport:WRO', 'departure_city_name': 'Вроцлав', 'departure_city_id': 'City:wroclaw_pl', 'departure_name': 'Вроцлавський аеропорт ім. М. Коперника', 'departure_country_code': 'PL', 'departure_country_id': 'Country:PL', 'arrival_station_code': 'BGY', 'arrival_id': 'Station:airport:BGY', 'arrival_city_name': 'Мілан', 'arrival_city_id': 'City:milan_it', 'arrival_name': 'Milan Bergamo International Airport', 'arrival_country_code': 'IT', 'arrival_country_id': 'Country:IT', 'airline': 'Ryanair', 'departure_local_time': datetime(2024, 10, 23, 20, 45), 'departure_utc_time': datetime(2024, 10, 23, 18, 45), 'arrival_local_time': datetime(2024, 10, 23, 22, 25), 'arrival_utc_time': datetime(2024, 10, 23, 20, 25), 'price': 20.4392, 'price_eur': 18.43, 'seats_left': None}, {'departure_station_code': 'WRO', 'departure_id': 'Station:airport:WRO', 'departure_city_name': 'Вроцлав', 'departure_city_id': 'City:wroclaw_pl', 'departure_name': 'Вроцлавський аеропорт ім. М. Коперника', 'departure_country_code': 'PL', 'departure_country_id': 'Country:PL', 'arrival_station_code': 'BGY', 'arrival_id': 'Station:airport:BGY', 'arrival_city_name': 'Мілан', 'arrival_city_id': 'City:milan_it', 'arrival_name': 'Milan Bergamo International Airport', 'arrival_country_code': 'IT', 'arrival_country_id': 'Country:IT', 'airline': 'Ryanair', 'departure_local_time': datetime(2024, 10, 20, 21, 45), 'departure_utc_time': datetime(2024, 10, 20, 19, 45), 'arrival_local_time': datetime(2024, 10, 20, 23, 25), 'arrival_utc_time': datetime(2024, 10, 20, 21, 25), 'price': 20.4392, 'price_eur': 18.43, 'seats_left': None}, {'departure_station_code': 'WRO', 'departure_id': 'Station:airport:WRO', 'departure_city_name': 'Вроцлав', 'departure_city_id': 'City:wroclaw_pl', 'departure_name': 'Вроцлавський аеропорт ім. М. Коперника', 'departure_country_code': 'PL', 'departure_country_id': 'Country:PL', 'arrival_station_code': 'BGY', 'arrival_id': 'Station:airport:BGY', 'arrival_city_name': 'Мілан', 'arrival_city_id': 'City:milan_it', 'arrival_name': 'Milan Bergamo International Airport', 'arrival_country_code': 'IT', 'arrival_country_id': 'Country:IT', 'airline': 'Ryanair', 'departure_local_time': datetime(2024, 10, 2, 20, 45), 'departure_utc_time': datetime(2024, 10, 2, 18, 45), 'arrival_local_time': datetime(2024, 10, 2, 22, 25), 'arrival_utc_time': datetime(2024, 10, 2, 20, 25), 'price': 20.4392, 'price_eur': 18.43, 'seats_left': None}, {'departure_station_code': 'WRO', 'departure_id': 'Station:airport:WRO', 'departure_city_name': 'Вроцлав', 'departure_city_id': 'City:wroclaw_pl', 'departure_name': 'Вроцлавський аеропорт ім. М. Коперника', 'departure_country_code': 'PL', 'departure_country_id': 'Country:PL', 'arrival_station_code': 'BGY', 'arrival_id': 'Station:airport:BGY', 'arrival_city_name': 'Мілан', 'arrival_city_id': 'City:milan_it', 'arrival_name': 'Milan Bergamo International Airport', 'arrival_country_code': 'IT', 'arrival_country_id': 'Country:IT', 'airline': 'Ryanair', 'departure_local_time': datetime(2024, 10, 8, 5, 45), 'departure_utc_time': datetime(2024, 10, 8, 3, 45), 'arrival_local_time': datetime(2024, 10, 8, 7, 25), 'arrival_utc_time': datetime(2024, 10, 8, 5, 25), 'price': 20.4392, 'price_eur': 18.43, 'seats_left': None}, {'departure_station_code': 'WRO', 'departure_id': 'Station:airport:WRO', 'departure_city_name': 'Вроцлав', 'departure_city_id': 'City:wroclaw_pl', 'departure_name': 'Вроцлавський аеропорт ім. М. Коперника', 'departure_country_code': 'PL', 'departure_country_id': 'Country:PL', 'arrival_station_code': 'BGY', 'arrival_id': 'Station:airport:BGY', 'arrival_city_name': 'Мілан', 'arrival_city_id': 'City:milan_it', 'arrival_name': 'Milan Bergamo International Airport', 'arrival_country_code': 'IT', 'arrival_country_id': 'Country:IT', 'airline': 'Ryanair', 'departure_local_time': datetime(2024, 10, 15, 5, 45), 'departure_utc_time': datetime(2024, 10, 15, 3, 45), 'arrival_local_time': datetime(2024, 10, 15, 7, 25), 'arrival_utc_time': datetime(2024, 10, 15, 5, 25), 'price': 20.4392, 'price_eur': 18.43, 'seats_left': 1}, {'departure_station_code': 'WRO', 'departure_id': 'Station:airport:WRO', 'departure_city_name': 'Вроцлав', 'departure_city_id': 'City:wroclaw_pl', 'departure_name': 'Вроцлавський аеропорт ім. М. Коперника', 'departure_country_code': 'PL', 'departure_country_id': 'Country:PL', 'arrival_station_code': 'BGY', 'arrival_id': 'Station:airport:BGY', 'arrival_city_name': 'Мілан', 'arrival_city_id': 'City:milan_it', 'arrival_name': 'Milan Bergamo International Airport', 'arrival_country_code': 'IT', 'arrival_country_id': 'Country:IT', 'airline': 'Ryanair', 'departure_local_time': datetime(2024, 10, 19, 17, 45), 'departure_utc_time': datetime(2024, 10, 19, 15, 45), 'arrival_local_time': datetime(2024, 10, 19, 19, 25), 'arrival_utc_time': datetime(2024, 10, 19, 17, 25), 'price': 20.4392, 'price_eur': 18.43, 'seats_left': None}, {'departure_station_code': 'KTW', 'departure_id': 'Station:airport:KTW', 'departure_city_name': 'Катовіце', 'departure_city_id': 'City:katowice_pl', 'departure_name': 'Міжнародний аеропорт Катовіце-Пижовіце', 'departure_country_code': 'PL', 'departure_country_id': 'Country:PL', 'arrival_station_code': 'BGY', 'arrival_id': 'Station:airport:BGY', 'arrival_city_name': 'Мілан', 'arrival_city_id': 'City:milan_it', 'arrival_name': 'Milan Bergamo International Airport', 'arrival_country_code': 'IT', 'arrival_country_id': 'Country:IT', 'airline': 'Ryanair', 'departure_local_time': datetime(2024, 10, 23, 21, 10), 'departure_utc_time': datetime(2024, 10, 23, 19, 10), 'arrival_local_time': datetime(2024, 10, 23, 22, 55), 'arrival_utc_time': datetime(2024, 10, 23, 20, 55), 'price': 20.4392, 'price_eur': 18.43, 'seats_left': None}, {'departure_station_code': 'KTW', 'departure_id': 'Station:airport:KTW', 'departure_city_name': 'Катовіце', 'departure_city_id': 'City:katowice_pl', 'departure_name': 'Міжнародний аеропорт Катовіце-Пижовіце', 'departure_country_code': 'PL', 'departure_country_id': 'Country:PL', 'arrival_station_code': 'BGY', 'arrival_id': 'Station:airport:BGY', 'arrival_city_name': 'Мілан', 'arrival_city_id': 'City:milan_it', 'arrival_name': 'Milan Bergamo International Airport', 'arrival_country_code': 'IT', 'arrival_country_id': 'Country:IT', 'airline': 'Ryanair', 'departure_local_time': datetime(2024, 10, 16, 21, 10), 'departure_utc_time': datetime(2024, 10, 16, 19, 10), 'arrival_local_time': datetime(2024, 10, 16, 22, 55), 'arrival_utc_time': datetime(2024, 10, 16, 20, 55), 'price': 20.4392, 'price_eur': 18.43, 'seats_left': None}, {'departure_station_code': 'KTW', 'departure_id': 'Station:airport:KTW', 'departure_city_name': 'Катовіце', 'departure_city_id': 'City:katowice_pl', 'departure_name': 'Міжнародний аеропорт Катовіце-Пижовіце', 'departure_country_code': 'PL', 'departure_country_id': 'Country:PL', 'arrival_station_code': 'BGY', 'arrival_id': 'Station:airport:BGY', 'arrival_city_name': 'Мілан', 'arrival_city_id': 'City:milan_it', 'arrival_name': 'Milan Bergamo International Airport', 'arrival_country_code': 'IT', 'arrival_country_id': 'Country:IT', 'airline': 'Ryanair', 'departure_local_time': datetime(2024, 10, 22, 20, 50), 'departure_utc_time': datetime(2024, 10, 22, 18, 50), 'arrival_local_time': datetime(2024, 10, 22, 22, 35), 'arrival_utc_time': datetime(2024, 10, 22, 20, 35), 'price': 20.4392, 'price_eur': 18.43, 'seats_left': None}, {'departure_station_code': 'KTW', 'departure_id': 'Station:airport:KTW', 'departure_city_name': 'Катовіце', 'departure_city_id': 'City:katowice_pl', 'departure_name': 'Міжнародний аеропорт Катовіце-Пижовіце', 'departure_country_code': 'PL', 'departure_country_id': 'Country:PL', 'arrival_station_code': 'BGY', 'arrival_id': 'Station:airport:BGY', 'arrival_city_name': 'Мілан', 'arrival_city_id': 'City:milan_it', 'arrival_name': 'Milan Bergamo International Airport', 'arrival_country_code': 'IT', 'arrival_country_id': 'Country:IT', 'airline': 'Ryanair', 'departure_local_time': datetime(2024, 10, 15, 20, 50), 'departure_utc_time': datetime(2024, 10, 15, 18, 50), 'arrival_local_time': datetime(2024, 10, 15, 22, 35), 'arrival_utc_time': datetime(2024, 10, 15, 20, 35), 'price': 20.4392, 'price_eur': 18.43, 'seats_left': None}, {'departure_station_code': 'KTW', 'departure_id': 'Station:airport:KTW', 'departure_city_name': 'Катовіце', 'departure_city_id': 'City:katowice_pl', 'departure_name': 'Міжнародний аеропорт Катовіце-Пижовіце', 'departure_country_code': 'PL', 'departure_country_id': 'Country:PL', 'arrival_station_code': 'BGY', 'arrival_id': 'Station:airport:BGY', 'arrival_city_name': 'Мілан', 'arrival_city_id': 'City:milan_it', 'arrival_name': 'Milan Bergamo International Airport', 'arrival_country_code': 'IT', 'arrival_country_id': 'Country:IT', 'airline': 'Ryanair', 'departure_local_time': datetime(2024, 10, 17, 21, 20), 'departure_utc_time': datetime(2024, 10, 17, 19, 20), 'arrival_local_time': datetime(2024, 10, 17, 23, 5), 'arrival_utc_time': datetime(2024, 10, 17, 21, 5), 'price': 20.4392, 'price_eur': 18.43, 'seats_left': None}, {'departure_station_code': 'KTW', 'departure_id': 'Station:airport:KTW', 'departure_city_name': 'Катовіце', 'departure_city_id': 'City:katowice_pl', 'departure_name': 'Міжнародний аеропорт Катовіце-Пижовіце', 'departure_country_code': 'PL', 'departure_country_id': 'Country:PL', 'arrival_station_code': 'BGY', 'arrival_id': 'Station:airport:BGY', 'arrival_city_name': 'Мілан', 'arrival_city_id': 'City:milan_it', 'arrival_name': 'Milan Bergamo International Airport', 'arrival_country_code': 'IT', 'arrival_country_id': 'Country:IT', 'airline': 'Ryanair', 'departure_local_time': datetime(2024, 9, 22, 20, 50), 'departure_utc_time': datetime(2024, 9, 22, 18, 50), 'arrival_local_time': datetime(2024, 9, 22, 22, 35), 'arrival_utc_time': datetime(2024, 9, 22, 20, 35), 'price': 20.4392, 'price_eur': 18.43, 'seats_left': None}]
#     flights2 = [{'departure_station_code': 'MXP', 'departure_id': 'Station:airport:MXP', 'departure_city_name': 'Мілан', 'departure_city_id': 'City:milan_it', 'departure_name': 'Аеропорт Мілан Мальпенса', 'departure_country_code': 'IT', 'departure_country_id': 'Country:IT', 'arrival_station_code': 'BCN', 'arrival_id': 'Station:airport:BCN', 'arrival_city_name': 'Барселона', 'arrival_city_id': 'City:barcelona_es', 'arrival_name': 'Барселона - Ель-Прат', 'arrival_country_code': 'ES', 'arrival_country_id': 'Country:ES', 'airline': 'Ryanair', 'departure_local_time': datetime(2024, 10, 29, 14, 30), 'departure_utc_time': datetime(2024, 10, 29, 13, 30), 'arrival_local_time': datetime(2024, 10, 29, 16, 5), 'arrival_utc_time': datetime(2024, 10, 29, 15, 5), 'price': 18.9515, 'price_eur': 17.0886, 'seats_left': None}, {'departure_station_code': 'BGY', 'departure_id': 'Station:airport:BGY', 'departure_city_name': 'Мілан', 'departure_city_id': 'City:milan_it', 'departure_name': 'Milan Bergamo International Airport', 'departure_country_code': 'IT', 'departure_country_id': 'Country:IT', 'arrival_station_code': 'BCN', 'arrival_id': 'Station:airport:BCN', 'arrival_city_name': 'Барселона', 'arrival_city_id': 'City:barcelona_es', 'arrival_name': 'Барселона - Ель-Прат', 'arrival_country_code': 'ES', 'arrival_country_id': 'Country:ES', 'airline': 'Ryanair', 'departure_local_time': datetime(2024, 10, 28, 20, 50), 'departure_utc_time': datetime(2024, 10, 28, 19, 50), 'arrival_local_time': datetime(2024, 10, 28, 22, 25), 'arrival_utc_time': datetime(2024, 10, 28, 21, 25), 'price': 18.9515, 'price_eur': 17.0886, 'seats_left': None}, {'departure_station_code': 'BGY', 'departure_id': 'Station:airport:BGY', 'departure_city_name': 'Мілан', 'departure_city_id': 'City:milan_it', 'departure_name': 'Milan Bergamo International Airport', 'departure_country_code': 'IT', 'departure_country_id': 'Country:IT', 'arrival_station_code': 'BCN', 'arrival_id': 'Station:airport:BCN', 'arrival_city_name': 'Барселона', 'arrival_city_id': 'City:barcelona_es', 'arrival_name': 'Барселона - Ель-Прат', 'arrival_country_code': 'ES', 'arrival_country_id': 'Country:ES', 'airline': 'Ryanair', 'departure_local_time': datetime(2024, 10, 28, 17, 40), 'departure_utc_time': datetime(2024, 10, 28, 16, 40), 'arrival_local_time': datetime(2024, 10, 28, 19, 15), 'arrival_utc_time': datetime(2024, 10, 28, 18, 15), 'price': 18.9515, 'price_eur': 17.0886, 'seats_left': None}, {'departure_station_code': 'MXP', 'departure_id': 'Station:airport:MXP', 'departure_city_name': 'Мілан', 'departure_city_id': 'City:milan_it', 'departure_name': 'Аеропорт Мілан Мальпенса', 'departure_country_code': 'IT', 'departure_country_id': 'Country:IT', 'arrival_station_code': 'BCN', 'arrival_id': 'Station:airport:BCN', 'arrival_city_name': 'Барселона', 'arrival_city_id': 'City:barcelona_es', 'arrival_name': 'Барселона - Ель-Прат', 'arrival_country_code': 'ES', 'arrival_country_id': 'Country:ES', 'airline': 'Ryanair', 'departure_local_time': datetime(2024, 10, 28, 11, 55), 'departure_utc_time': datetime(2024, 10, 28, 10, 55), 'arrival_local_time': datetime(2024, 10, 28, 13, 30), 'arrival_utc_time': datetime(2024, 10, 28, 12, 30), 'price': 18.9515, 'price_eur': 17.0886, 'seats_left': None}, {'departure_station_code': 'BGY', 'departure_id': 'Station:airport:BGY', 'departure_city_name': 'Мілан', 'departure_city_id': 'City:milan_it', 'departure_name': 'Milan Bergamo International Airport', 'departure_country_code': 'IT', 'departure_country_id': 'Country:IT', 'arrival_station_code': 'BCN', 'arrival_id': 'Station:airport:BCN', 'arrival_city_name': 'Барселона', 'arrival_city_id': 'City:barcelona_es', 'arrival_name': 'Барселона - Ель-Прат', 'arrival_country_code': 'ES', 'arrival_country_id': 'Country:ES', 'airline': 'Ryanair', 'departure_local_time': datetime(2024, 10, 28, 5, 50), 'departure_utc_time': datetime(2024, 10, 28, 4, 50), 'arrival_local_time': datetime(2024, 10, 28, 7, 25), 'arrival_utc_time': datetime(2024, 10, 28, 6, 25), 'price': 18.9515, 'price_eur': 17.0886, 'seats_left': None}, {'departure_station_code': 'BGY', 'departure_id': 'Station:airport:BGY', 'departure_city_name': 'Мілан', 'departure_city_id': 'City:milan_it', 'departure_name': 'Milan Bergamo International Airport', 'departure_country_code': 'IT', 'departure_country_id': 'Country:IT', 'arrival_station_code': 'BCN', 'arrival_id': 'Station:airport:BCN', 'arrival_city_name': 'Барселона', 'arrival_city_id': 'City:barcelona_es', 'arrival_name': 'Барселона - Ель-Прат', 'arrival_country_code': 'ES', 'arrival_country_id': 'Country:ES', 'airline': 'Ryanair', 'departure_local_time': datetime(2024, 10, 22, 22, 15), 'departure_utc_time': datetime(2024, 10, 22, 20, 15), 'arrival_local_time': datetime(2024, 10, 22, 23, 55), 'arrival_utc_time': datetime(2024, 10, 22, 21, 55), 'price': 18.9515, 'price_eur': 17.0886, 'seats_left': None}, {'departure_station_code': 'BGY', 'departure_id': 'Station:airport:BGY', 'departure_city_name': 'Мілан', 'departure_city_id': 'City:milan_it', 'departure_name': 'Milan Bergamo International Airport', 'departure_country_code': 'IT', 'departure_country_id': 'Country:IT', 'arrival_station_code': 'BCN', 'arrival_id': 'Station:airport:BCN', 'arrival_city_name': 'Барселона', 'arrival_city_id': 'City:barcelona_es', 'arrival_name': 'Барселона - Ель-Прат', 'arrival_country_code': 'ES', 'arrival_country_id': 'Country:ES', 'airline': 'Ryanair', 'departure_local_time': datetime(2024, 10, 22, 15, 40), 'departure_utc_time': datetime(2024, 10, 22, 13, 40), 'arrival_local_time': datetime(2024, 10, 22, 17, 20), 'arrival_utc_time': datetime(2024, 10, 22, 15, 20), 'price': 18.9515, 'price_eur': 17.0886, 'seats_left': None}, {'departure_station_code': 'BGY', 'departure_id': 'Station:airport:BGY', 'departure_city_name': 'Мілан', 'departure_city_id': 'City:milan_it', 'departure_name': 'Milan Bergamo International Airport', 'departure_country_code': 'IT', 'departure_country_id': 'Country:IT', 'arrival_station_code': 'BCN', 'arrival_id': 'Station:airport:BCN', 'arrival_city_name': 'Барселона', 'arrival_city_id': 'City:barcelona_es', 'arrival_name': 'Барселона - Ель-Прат', 'arrival_country_code': 'ES', 'arrival_country_id': 'Country:ES', 'airline': 'Ryanair', 'departure_local_time': datetime(2024, 10, 14, 20, 25), 'departure_utc_time': datetime(2024, 10, 14, 18, 25), 'arrival_local_time': datetime(2024, 10, 14, 22, 5), 'arrival_utc_time': datetime(2024, 10, 14, 20, 5), 'price': 18.9515, 'price_eur': 17.0886, 'seats_left': None}, {'departure_station_code': 'BGY', 'departure_id': 'Station:airport:BGY', 'departure_city_name': 'Мілан', 'departure_city_id': 'City:milan_it', 'departure_name': 'Milan Bergamo International Airport', 'departure_country_code': 'IT', 'departure_country_id': 'Country:IT', 'arrival_station_code': 'BCN', 'arrival_id': 'Station:airport:BCN', 'arrival_city_name': 'Барселона', 'arrival_city_id': 'City:barcelona_es', 'arrival_name': 'Барселона - Ель-Прат', 'arrival_country_code': 'ES', 'arrival_country_id': 'Country:ES', 'airline': 'Ryanair', 'departure_local_time': datetime(2024, 10, 14, 13, 0), 'departure_utc_time': datetime(2024, 10, 14, 11, 0), 'arrival_local_time': datetime(2024, 10, 14, 14, 40), 'arrival_utc_time': datetime(2024, 10, 14, 12, 40), 'price': 18.9515, 'price_eur': 17.0886, 'seats_left': None}, {'departure_station_code': 'BGY', 'departure_id': 'Station:airport:BGY', 'departure_city_name': 'Мілан', 'departure_city_id': 'City:milan_it', 'departure_name': 'Milan Bergamo International Airport', 'departure_country_code': 'IT', 'departure_country_id': 'Country:IT', 'arrival_station_code': 'BCN', 'arrival_id': 'Station:airport:BCN', 'arrival_city_name': 'Барселона', 'arrival_city_id': 'City:barcelona_es', 'arrival_name': 'Барселона - Ель-Прат', 'arrival_country_code': 'ES', 'arrival_country_id': 'Country:ES', 'airline': 'Ryanair', 'departure_local_time': datetime(2024, 10, 15, 15, 40), 'departure_utc_time': datetime(2024, 10, 15, 13, 40), 'arrival_local_time': datetime(2024, 10, 15, 17, 20), 'arrival_utc_time': datetime(2024, 10, 15, 15, 20), 'price': 18.9515, 'price_eur': 17.0886, 'seats_left': None}, {'departure_station_code': 'BGY', 'departure_id': 'Station:airport:BGY', 'departure_city_name': 'Мілан', 'departure_city_id': 'City:milan_it', 'departure_name': 'Milan Bergamo International Airport', 'departure_country_code': 'IT', 'departure_country_id': 'Country:IT', 'arrival_station_code': 'BCN', 'arrival_id': 'Station:airport:BCN', 'arrival_city_name': 'Барселона', 'arrival_city_id': 'City:barcelona_es', 'arrival_name': 'Барселона - Ель-Прат', 'arrival_country_code': 'ES', 'arrival_country_id': 'Country:ES', 'airline': 'Ryanair', 'departure_local_time': datetime(2024, 10, 21, 14, 0), 'departure_utc_time': datetime(2024, 10, 21, 12, 0), 'arrival_local_time': datetime(2024, 10, 21, 15, 40), 'arrival_utc_time': datetime(2024, 10, 21, 13, 40), 'price': 18.9515, 'price_eur': 17.0886, 'seats_left': None}, {'departure_station_code': 'BGY', 'departure_id': 'Station:airport:BGY', 'departure_city_name': 'Мілан', 'departure_city_id': 'City:milan_it', 'departure_name': 'Milan Bergamo International Airport', 'departure_country_code': 'IT', 'departure_country_id': 'Country:IT', 'arrival_station_code': 'BCN', 'arrival_id': 'Station:airport:BCN', 'arrival_city_name': 'Барселона', 'arrival_city_id': 'City:barcelona_es', 'arrival_name': 'Барселона - Ель-Прат', 'arrival_country_code': 'ES', 'arrival_country_id': 'Country:ES', 'airline': 'Ryanair', 'departure_local_time': datetime(2024, 10, 10, 23, 35), 'departure_utc_time': datetime(2024, 10, 10, 21, 35), 'arrival_local_time': datetime(2024, 10, 11, 1, 15), 'arrival_utc_time': datetime(2024, 10, 10, 23, 15), 'price': 18.9515, 'price_eur': 17.0886, 'seats_left': None}, {'departure_station_code': 'BGY', 'departure_id': 'Station:airport:BGY', 'departure_city_name': 'Мілан', 'departure_city_id': 'City:milan_it', 'departure_name': 'Milan Bergamo International Airport', 'departure_country_code': 'IT', 'departure_country_id': 'Country:IT', 'arrival_station_code': 'BCN', 'arrival_id': 'Station:airport:BCN', 'arrival_city_name': 'Барселона', 'arrival_city_id': 'City:barcelona_es', 'arrival_name': 'Барселона - Ель-Прат', 'arrival_country_code': 'ES', 'arrival_country_id': 'Country:ES', 'airline': 'Ryanair', 'departure_local_time': datetime(2024, 10, 17, 10, 35), 'departure_utc_time': datetime(2024, 10, 17, 8, 35), 'arrival_local_time': datetime(2024, 10, 17, 12, 15), 'arrival_utc_time': datetime(2024, 10, 17, 10, 15), 'price': 18.9515, 'price_eur': 17.0886, 'seats_left': 4}, {'departure_station_code': 'BGY', 'departure_id': 'Station:airport:BGY', 'departure_city_name': 'Мілан', 'departure_city_id': 'City:milan_it', 'departure_name': 'Milan Bergamo International Airport', 'departure_country_code': 'IT', 'departure_country_id': 'Country:IT', 'arrival_station_code': 'BCN', 'arrival_id': 'Station:airport:BCN', 'arrival_city_name': 'Барселона', 'arrival_city_id': 'City:barcelona_es', 'arrival_name': 'Барселона - Ель-Прат', 'arrival_country_code': 'ES', 'arrival_country_id': 'Country:ES', 'airline': 'Ryanair', 'departure_local_time': datetime(2024, 10, 16, 14, 30), 'departure_utc_time': datetime(2024, 10, 16, 12, 30), 'arrival_local_time': datetime(2024, 10, 16, 16, 10), 'arrival_utc_time': datetime(2024, 10, 16, 14, 10), 'price': 18.9515, 'price_eur': 17.0886, 'seats_left': None}, {'departure_station_code': 'BGY', 'departure_id': 'Station:airport:BGY', 'departure_city_name': 'Мілан', 'departure_city_id': 'City:milan_it', 'departure_name': 'Milan Bergamo International Airport', 'departure_country_code': 'IT', 'departure_country_id': 'Country:IT', 'arrival_station_code': 'BCN', 'arrival_id': 'Station:airport:BCN', 'arrival_city_name': 'Барселона', 'arrival_city_id': 'City:barcelona_es', 'arrival_name': 'Барселона - Ель-Прат', 'arrival_country_code': 'ES', 'arrival_country_id': 'Country:ES', 'airline': 'Ryanair', 'departure_local_time': datetime(2024, 10, 16, 21, 20), 'departure_utc_time': datetime(2024, 10, 16, 19, 20), 'arrival_local_time': datetime(2024, 10, 16, 23, 0), 'arrival_utc_time': datetime(2024, 10, 16, 21, 0), 'price': 18.9515, 'price_eur': 17.0886, 'seats_left': None}, {'departure_station_code': 'BGY', 'departure_id': 'Station:airport:BGY', 'departure_city_name': 'Мілан', 'departure_city_id': 'City:milan_it', 'departure_name': 'Milan Bergamo International Airport', 'departure_country_code': 'IT', 'departure_country_id': 'Country:IT', 'arrival_station_code': 'BCN', 'arrival_id': 'Station:airport:BCN', 'arrival_city_name': 'Барселона', 'arrival_city_id': 'City:barcelona_es', 'arrival_name': 'Барселона - Ель-Прат', 'arrival_country_code': 'ES', 'arrival_country_id': 'Country:ES', 'airline': 'Ryanair', 'departure_local_time': datetime(2024, 10, 15, 22, 15), 'departure_utc_time': datetime(2024, 10, 15, 20, 15), 'arrival_local_time': datetime(2024, 10, 15, 23, 55), 'arrival_utc_time': datetime(2024, 10, 15, 21, 55), 'price': 18.9515, 'price_eur': 17.0886, 'seats_left': None}, {'departure_station_code': 'BGY', 'departure_id': 'Station:airport:BGY', 'departure_city_name': 'Мілан', 'departure_city_id': 'City:milan_it', 'departure_name': 'Milan Bergamo International Airport', 'departure_country_code': 'IT', 'departure_country_id': 'Country:IT', 'arrival_station_code': 'BCN', 'arrival_id': 'Station:airport:BCN', 'arrival_city_name': 'Барселона', 'arrival_city_id': 'City:barcelona_es', 'arrival_name': 'Барселона - Ель-Прат', 'arrival_country_code': 'ES', 'arrival_country_id': 'Country:ES', 'airline': 'Ryanair', 'departure_local_time': datetime(2024, 10, 17, 23, 35), 'departure_utc_time': datetime(2024, 10, 17, 21, 35), 'arrival_local_time': datetime(2024, 10, 18, 1, 15), 'arrival_utc_time': datetime(2024, 10, 17, 23, 15), 'price': 18.9515, 'price_eur': 17.0886, 'seats_left': None}, {'departure_station_code': 'BGY', 'departure_id': 'Station:airport:BGY', 'departure_city_name': 'Мілан', 'departure_city_id': 'City:milan_it', 'departure_name': 'Milan Bergamo International Airport', 'departure_country_code': 'IT', 'departure_country_id': 'Country:IT', 'arrival_station_code': 'BCN', 'arrival_id': 'Station:airport:BCN', 'arrival_city_name': 'Барселона', 'arrival_city_id': 'City:barcelona_es', 'arrival_name': 'Барселона - Ель-Прат', 'arrival_country_code': 'ES', 'arrival_country_id': 'Country:ES', 'airline': 'Ryanair', 'departure_local_time': datetime(2024, 10, 10, 15, 25), 'departure_utc_time': datetime(2024, 10, 10, 13, 25), 'arrival_local_time': datetime(2024, 10, 10, 17, 5), 'arrival_utc_time': datetime(2024, 10, 10, 15, 5), 'price': 18.9515, 'price_eur': 17.0886, 'seats_left': None}, {'departure_station_code': 'BGY', 'departure_id': 'Station:airport:BGY', 'departure_city_name': 'Мілан', 'departure_city_id': 'City:milan_it', 'departure_name': 'Milan Bergamo International Airport', 'departure_country_code': 'IT', 'departure_country_id': 'Country:IT', 'arrival_station_code': 'BCN', 'arrival_id': 'Station:airport:BCN', 'arrival_city_name': 'Барселона', 'arrival_city_id': 'City:barcelona_es', 'arrival_name': 'Барселона - Ель-Прат', 'arrival_country_code': 'ES', 'arrival_country_id': 'Country:ES', 'airline': 'Ryanair', 'departure_local_time': datetime(2024, 10, 15, 17, 45), 'departure_utc_time': datetime(2024, 10, 15, 15, 45), 'arrival_local_time': datetime(2024, 10, 15, 19, 25), 'arrival_utc_time': datetime(2024, 10, 15, 17, 25), 'price': 18.9515, 'price_eur': 17.0886, 'seats_left': None}, {'departure_station_code': 'MXP', 'departure_id': 'Station:airport:MXP', 'departure_city_name': 'Мілан', 'departure_city_id': 'City:milan_it', 'departure_name': 'Аеропорт Мілан Мальпенса', 'departure_country_code': 'IT', 'departure_country_id': 'Country:IT', 'arrival_station_code': 'BCN', 'arrival_id': 'Station:airport:BCN', 'arrival_city_name': 'Барселона', 'arrival_city_id': 'City:barcelona_es', 'arrival_name': 'Барселона - Ель-Прат', 'arrival_country_code': 'ES', 'arrival_country_id': 'Country:ES', 'airline': 'Ryanair', 'departure_local_time': datetime(2024, 10, 22, 14, 25), 'departure_utc_time': datetime(2024, 10, 22, 12, 25), 'arrival_local_time': datetime(2024, 10, 22, 16, 5), 'arrival_utc_time': datetime(2024, 10, 22, 14, 5), 'price': 18.9515, 'price_eur': 17.0886, 'seats_left': None}, {'departure_station_code': 'BGY', 'departure_id': 'Station:airport:BGY', 'departure_city_name': 'Мілан', 'departure_city_id': 'City:milan_it', 'departure_name': 'Milan Bergamo International Airport', 'departure_country_code': 'IT', 'departure_country_id': 'Country:IT', 'arrival_station_code': 'BCN', 'arrival_id': 'Station:airport:BCN', 'arrival_city_name': 'Барселона', 'arrival_city_id': 'City:barcelona_es', 'arrival_name': 'Барселона - Ель-Прат', 'arrival_country_code': 'ES', 'arrival_country_id': 'Country:ES', 'airline': 'Ryanair', 'departure_local_time': datetime(2024, 10, 19, 19, 0), 'departure_utc_time': datetime(2024, 10, 19, 17, 0), 'arrival_local_time': datetime(2024, 10, 19, 20, 40), 'arrival_utc_time': datetime(2024, 10, 19, 18, 40), 'price': 18.9515, 'price_eur': 17.0886, 'seats_left': None}, {'departure_station_code': 'BGY', 'departure_id': 'Station:airport:BGY', 'departure_city_name': 'Мілан', 'departure_city_id': 'City:milan_it', 'departure_name': 'Milan Bergamo International Airport', 'departure_country_code': 'IT', 'departure_country_id': 'Country:IT', 'arrival_station_code': 'BCN', 'arrival_id': 'Station:airport:BCN', 'arrival_city_name': 'Барселона', 'arrival_city_id': 'City:barcelona_es', 'arrival_name': 'Барселона - Ель-Прат', 'arrival_country_code': 'ES', 'arrival_country_id': 'Country:ES', 'airline': 'Ryanair', 'departure_local_time': datetime(2024, 10, 19, 21, 55), 'departure_utc_time': datetime(2024, 10, 19, 19, 55), 'arrival_local_time': datetime(2024, 10, 19, 23, 35), 'arrival_utc_time': datetime(2024, 10, 19, 21, 35), 'price': 18.9515, 'price_eur': 17.0886, 'seats_left': None}, {'departure_station_code': 'BGY', 'departure_id': 'Station:airport:BGY', 'departure_city_name': 'Мілан', 'departure_city_id': 'City:milan_it', 'departure_name': 'Milan Bergamo International Airport', 'departure_country_code': 'IT', 'departure_country_id': 'Country:IT', 'arrival_station_code': 'BCN', 'arrival_id': 'Station:airport:BCN', 'arrival_city_name': 'Барселона', 'arrival_city_id': 'City:barcelona_es', 'arrival_name': 'Барселона - Ель-Прат', 'arrival_country_code': 'ES', 'arrival_country_id': 'Country:ES', 'airline': 'Ryanair', 'departure_local_time': datetime(2024, 10, 24, 23, 35), 'departure_utc_time': datetime(2024, 10, 24, 21, 35), 'arrival_local_time': datetime(2024, 10, 25, 1, 15), 'arrival_utc_time': datetime(2024, 10, 24, 23, 15), 'price': 18.9515, 'price_eur': 17.0886, 'seats_left': None}, {'departure_station_code': 'BGY', 'departure_id': 'Station:airport:BGY', 'departure_city_name': 'Мілан', 'departure_city_id': 'City:milan_it', 'departure_name': 'Milan Bergamo International Airport', 'departure_country_code': 'IT', 'departure_country_id': 'Country:IT', 'arrival_station_code': 'BCN', 'arrival_id': 'Station:airport:BCN', 'arrival_city_name': 'Барселона', 'arrival_city_id': 'City:barcelona_es', 'arrival_name': 'Барселона - Ель-Прат', 'arrival_country_code': 'ES', 'arrival_country_id': 'Country:ES', 'airline': 'Ryanair', 'departure_local_time': datetime(2024, 10, 24, 15, 25), 'departure_utc_time': datetime(2024, 10, 24, 13, 25), 'arrival_local_time': datetime(2024, 10, 24, 17, 5), 'arrival_utc_time': datetime(2024, 10, 24, 15, 5), 'price': 18.9515, 'price_eur': 17.0886, 'seats_left': None}, {'departure_station_code': 'FCO', 'departure_id': 'Station:airport:FCO', 'departure_city_name': 'Рим', 'departure_city_id': 'City:rome_it', 'departure_name': 'Міжнародний аеропорт імені Леонардо да Вінчі', 'departure_country_code': 'IT', 'departure_country_id': 'Country:IT', 'arrival_station_code': 'BCN', 'arrival_id': 'Station:airport:BCN', 'arrival_city_name': 'Барселона', 'arrival_city_id': 'City:barcelona_es', 'arrival_name': 'Барселона - Ель-Прат', 'arrival_country_code': 'ES', 'arrival_country_id': 'Country:ES', 'airline': 'Ryanair', 'departure_local_time': datetime(2024, 10, 15, 9, 0), 'departure_utc_time': datetime(2024, 10, 15, 7, 0), 'arrival_local_time': datetime(2024, 10, 15, 10, 40), 'arrival_utc_time': datetime(2024, 10, 15, 8, 40), 'price': 18.9515, 'price_eur': 17.0886, 'seats_left': None}, {'departure_station_code': 'BGY', 'departure_id': 'Station:airport:BGY', 'departure_city_name': 'Мілан', 'departure_city_id': 'City:milan_it', 'departure_name': 'Milan Bergamo International Airport', 'departure_country_code': 'IT', 'departure_country_id': 'Country:IT', 'arrival_station_code': 'BCN', 'arrival_id': 'Station:airport:BCN', 'arrival_city_name': 'Барселона', 'arrival_city_id': 'City:barcelona_es', 'arrival_name': 'Барселона - Ель-Прат', 'arrival_country_code': 'ES', 'arrival_country_id': 'Country:ES', 'airline': 'Ryanair', 'departure_local_time': datetime(2024, 10, 26, 21, 55), 'departure_utc_time': datetime(2024, 10, 26, 19, 55), 'arrival_local_time': datetime(2024, 10, 26, 23, 35), 'arrival_utc_time': datetime(2024, 10, 26, 21, 35), 'price': 18.9515, 'price_eur': 17.0886, 'seats_left': None}, {'departure_station_code': 'BGY', 'departure_id': 'Station:airport:BGY', 'departure_city_name': 'Мілан', 'departure_city_id': 'City:milan_it', 'departure_name': 'Milan Bergamo International Airport', 'departure_country_code': 'IT', 'departure_country_id': 'Country:IT', 'arrival_station_code': 'BCN', 'arrival_id': 'Station:airport:BCN', 'arrival_city_name': 'Барселона', 'arrival_city_id': 'City:barcelona_es', 'arrival_name': 'Барселона - Ель-Прат', 'arrival_country_code': 'ES', 'arrival_country_id': 'Country:ES', 'airline': 'Ryanair', 'departure_local_time': datetime(2024, 10, 23, 21, 20), 'departure_utc_time': datetime(2024, 10, 23, 19, 20), 'arrival_local_time': datetime(2024, 10, 23, 23, 0), 'arrival_utc_time': datetime(2024, 10, 23, 21, 0), 'price': 18.9515, 'price_eur': 17.0886, 'seats_left': None}, {'departure_station_code': 'BGY', 'departure_id': 'Station:airport:BGY', 'departure_city_name': 'Мілан', 'departure_city_id': 'City:milan_it', 'departure_name': 'Milan Bergamo International Airport', 'departure_country_code': 'IT', 'departure_country_id': 'Country:IT', 'arrival_station_code': 'BCN', 'arrival_id': 'Station:airport:BCN', 'arrival_city_name': 'Барселона', 'arrival_city_id': 'City:barcelona_es', 'arrival_name': 'Барселона - Ель-Прат', 'arrival_country_code': 'ES', 'arrival_country_id': 'Country:ES', 'airline': 'Ryanair', 'departure_local_time': datetime(2024, 10, 9, 21, 20), 'departure_utc_time': datetime(2024, 10, 9, 19, 20), 'arrival_local_time': datetime(2024, 10, 9, 23, 0), 'arrival_utc_time': datetime(2024, 10, 9, 21, 0), 'price': 18.9515, 'price_eur': 17.0886, 'seats_left': None}, {'departure_station_code': 'BGY', 'departure_id': 'Station:airport:BGY', 'departure_city_name': 'Мілан', 'departure_city_id': 'City:milan_it', 'departure_name': 'Milan Bergamo International Airport', 'departure_country_code': 'IT', 'departure_country_id': 'Country:IT', 'arrival_station_code': 'BCN', 'arrival_id': 'Station:airport:BCN', 'arrival_city_name': 'Барселона', 'arrival_city_id': 'City:barcelona_es', 'arrival_name': 'Барселона - Ель-Прат', 'arrival_country_code': 'ES', 'arrival_country_id': 'Country:ES', 'airline': 'Ryanair', 'departure_local_time': datetime(2024, 10, 7, 20, 25), 'departure_utc_time': datetime(2024, 10, 7, 18, 25), 'arrival_local_time': datetime(2024, 10, 7, 22, 5), 'arrival_utc_time': datetime(2024, 10, 7, 20, 5), 'price': 18.9515, 'price_eur': 17.0886, 'seats_left': None}, {'departure_station_code': 'MXP', 'departure_id': 'Station:airport:MXP', 'departure_city_name': 'Мілан', 'departure_city_id': 'City:milan_it', 'departure_name': 'Аеропорт Мілан Мальпенса', 'departure_country_code': 'IT', 'departure_country_id': 'Country:IT', 'arrival_station_code': 'BCN', 'arrival_id': 'Station:airport:BCN', 'arrival_city_name': 'Барселона', 'arrival_city_id': 'City:barcelona_es', 'arrival_name': 'Барселона - Ель-Прат', 'arrival_country_code': 'ES', 'arrival_country_id': 'Country:ES', 'airline': 'Ryanair', 'departure_local_time': datetime(2024, 9, 30, 23, 15), 'departure_utc_time': datetime(2024, 9, 30, 21, 15), 'arrival_local_time': datetime(2024, 10, 1, 0, 55), 'arrival_utc_time': datetime(2024, 9, 30, 22, 55), 'price': 18.9515, 'price_eur': 17.0886, 'seats_left': None}]
#     flights3 = [{'departure_station_code': 'BCN', 'departure_id': 'Station:airport:BCN', 'departure_city_name': 'Барселона', 'departure_city_id': 'City:barcelona_es', 'departure_name': 'Барселона - Ель-Прат', 'departure_country_code': 'ES', 'departure_country_id': 'Country:ES', 'arrival_station_code': 'KRK', 'arrival_id': 'Station:airport:KRK', 'arrival_city_name': 'Краків', 'arrival_city_id': 'City:krakow_pl', 'arrival_name': 'Міжнародний аеропорт Краків - Баліце ім. Іоана Павла ІІ', 'arrival_country_code': 'PL', 'arrival_country_id': 'Country:PL', 'airline': 'Ryanair', 'departure_local_time': datetime(2024, 12, 12, 9, 30), 'departure_utc_time': datetime(2024, 12, 12, 8, 30), 'arrival_local_time': datetime(2024, 12, 12, 12, 20), 'arrival_utc_time': datetime(2024, 12, 12, 11, 20), 'price': 31.5943, 'price_eur': 28.4886, 'seats_left': None}, {'departure_station_code': 'BCN', 'departure_id': 'Station:airport:BCN', 'departure_city_name': 'Барселона', 'departure_city_id': 'City:barcelona_es', 'departure_name': 'Барселона - Ель-Прат', 'departure_country_code': 'ES', 'departure_country_id': 'Country:ES', 'arrival_station_code': 'KRK', 'arrival_id': 'Station:airport:KRK', 'arrival_city_name': 'Краків', 'arrival_city_id': 'City:krakow_pl', 'arrival_name': 'Міжнародний аеропорт Краків - Баліце ім. Іоана Павла ІІ', 'arrival_country_code': 'PL', 'arrival_country_id': 'Country:PL', 'airline': 'Ryanair', 'departure_local_time': datetime(2024, 11, 21, 9, 30), 'departure_utc_time': datetime(2024, 11, 21, 8, 30), 'arrival_local_time': datetime(2024, 11, 21, 12, 20), 'arrival_utc_time': datetime(2024, 11, 21, 11, 20), 'price': 31.5943, 'price_eur': 28.4886, 'seats_left': 3}, {'departure_station_code': 'BCN', 'departure_id': 'Station:airport:BCN', 'departure_city_name': 'Барселона', 'departure_city_id': 'City:barcelona_es', 'departure_name': 'Барселона - Ель-Прат', 'departure_country_code': 'ES', 'departure_country_id': 'Country:ES', 'arrival_station_code': 'KRK', 'arrival_id': 'Station:airport:KRK', 'arrival_city_name': 'Краків', 'arrival_city_id': 'City:krakow_pl', 'arrival_name': 'Міжнародний аеропорт Краків - Баліце ім. Іоана Павла ІІ', 'arrival_country_code': 'PL', 'arrival_country_id': 'Country:PL', 'airline': 'Ryanair', 'departure_local_time': datetime(2024, 12, 11, 16, 20), 'departure_utc_time': datetime(2024, 12, 11, 15, 20), 'arrival_local_time': datetime(2024, 12, 11, 19, 10), 'arrival_utc_time': datetime(2024, 12, 11, 18, 10), 'price': 31.5943, 'price_eur': 28.4886, 'seats_left': None}, {'departure_station_code': 'BCN', 'departure_id': 'Station:airport:BCN', 'departure_city_name': 'Барселона', 'departure_city_id': 'City:barcelona_es', 'departure_name': 'Барселона - Ель-Прат', 'departure_country_code': 'ES', 'departure_country_id': 'Country:ES', 'arrival_station_code': 'WMI', 'arrival_id': 'Station:airport:WMI', 'arrival_city_name': 'Варшава', 'arrival_city_id': 'City:warsaw_pl', 'arrival_name': 'Аеропорт Варшава-Модлін', 'arrival_country_code': 'PL', 'arrival_country_id': 'Country:PL', 'airline': 'Ryanair', 'departure_local_time': datetime(2024, 11, 22, 20, 35), 'departure_utc_time': datetime(2024, 11, 22, 19, 35), 'arrival_local_time': datetime(2024, 11, 22, 23, 40), 'arrival_utc_time': datetime(2024, 11, 22, 22, 40), 'price': 31.5943, 'price_eur': 28.4886, 'seats_left': 4}, {'departure_station_code': 'MAD', 'departure_id': 'Station:airport:MAD', 'departure_city_name': 'Мадрид', 'departure_city_id': 'City:madrid_es', 'departure_name': 'Аеропорт Мадрид-Барахас', 'departure_country_code': 'ES', 'departure_country_id': 'Country:ES', 'arrival_station_code': 'WMI', 'arrival_id': 'Station:airport:WMI', 'arrival_city_name': 'Варшава', 'arrival_city_id': 'City:warsaw_pl', 'arrival_name': 'Аеропорт Варшава-Модлін', 'arrival_country_code': 'PL', 'arrival_country_id': 'Country:PL', 'airline': 'Ryanair', 'departure_local_time': datetime(2024, 12, 1, 20, 15), 'departure_utc_time': datetime(2024, 12, 1, 19, 15), 'arrival_local_time': datetime(2024, 12, 1, 23, 45), 'arrival_utc_time': datetime(2024, 12, 1, 22, 45), 'price': 31.5943, 'price_eur': 28.4886, 'seats_left': None}, {'departure_station_code': 'BCN', 'departure_id': 'Station:airport:BCN', 'departure_city_name': 'Барселона', 'departure_city_id': 'City:barcelona_es', 'departure_name': 'Барселона - Ель-Прат', 'departure_country_code': 'ES', 'departure_country_id': 'Country:ES', 'arrival_station_code': 'WMI', 'arrival_id': 'Station:airport:WMI', 'arrival_city_name': 'Варшава', 'arrival_city_id': 'City:warsaw_pl', 'arrival_name': 'Аеропорт Варшава-Модлін', 'arrival_country_code': 'PL', 'arrival_country_id': 'Country:PL', 'airline': 'Ryanair', 'departure_local_time': datetime(2024, 12, 6, 20, 35), 'departure_utc_time': datetime(2024, 12, 6, 19, 35), 'arrival_local_time': datetime(2024, 12, 6, 23, 40), 'arrival_utc_time': datetime(2024, 12, 6, 22, 40), 'price': 33.1747, 'price_eur': 29.9136, 'seats_left': None}, {'departure_station_code': 'BCN', 'departure_id': 'Station:airport:BCN', 'departure_city_name': 'Барселона', 'departure_city_id': 'City:barcelona_es', 'departure_name': 'Барселона - Ель-Прат', 'departure_country_code': 'ES', 'departure_country_id': 'Country:ES', 'arrival_station_code': 'WMI', 'arrival_id': 'Station:airport:WMI', 'arrival_city_name': 'Варшава', 'arrival_city_id': 'City:warsaw_pl', 'arrival_name': 'Аеропорт Варшава-Модлін', 'arrival_country_code': 'PL', 'arrival_country_id': 'Country:PL', 'airline': 'Ryanair', 'departure_local_time': datetime(2024, 12, 13, 20, 35), 'departure_utc_time': datetime(2024, 12, 13, 19, 35), 'arrival_local_time': datetime(2024, 12, 13, 23, 40), 'arrival_utc_time': datetime(2024, 12, 13, 22, 40), 'price': 34.2999, 'price_eur': 30.9282, 'seats_left': 4}, {'departure_station_code': 'MAD', 'departure_id': 'Station:airport:MAD', 'departure_city_name': 'Мадрид', 'departure_city_id': 'City:madrid_es', 'departure_name': 'Аеропорт Мадрид-Барахас', 'departure_country_code': 'ES', 'departure_country_id': 'Country:ES', 'arrival_station_code': 'WMI', 'arrival_id': 'Station:airport:WMI', 'arrival_city_name': 'Варшава', 'arrival_city_id': 'City:warsaw_pl', 'arrival_name': 'Аеропорт Варшава-Модлін', 'arrival_country_code': 'PL', 'arrival_country_id': 'Country:PL', 'airline': 'Ryanair', 'departure_local_time': datetime(2024, 11, 27, 10, 50), 'departure_utc_time': datetime(2024, 11, 27, 9, 50), 'arrival_local_time': datetime(2024, 11, 27, 14, 20), 'arrival_utc_time': datetime(2024, 11, 27, 13, 20), 'price': 34.5401, 'price_eur': 31.1448, 'seats_left': 4}, {'departure_station_code': 'MAD', 'departure_id': 'Station:airport:MAD', 'departure_city_name': 'Мадрид', 'departure_city_id': 'City:madrid_es', 'departure_name': 'Аеропорт Мадрид-Барахас', 'departure_country_code': 'ES', 'departure_country_id': 'Country:ES', 'arrival_station_code': 'WMI', 'arrival_id': 'Station:airport:WMI', 'arrival_city_name': 'Варшава', 'arrival_city_id': 'City:warsaw_pl', 'arrival_name': 'Аеропорт Варшава-Модлін', 'arrival_country_code': 'PL', 'arrival_country_id': 'Country:PL', 'airline': 'Ryanair', 'departure_local_time': datetime(2024, 11, 20, 10, 50), 'departure_utc_time': datetime(2024, 11, 20, 9, 50), 'arrival_local_time': datetime(2024, 11, 20, 14, 20), 'arrival_utc_time': datetime(2024, 11, 20, 13, 20), 'price': 37.6249, 'price_eur': 33.9264, 'seats_left': 3}, {'departure_station_code': 'BCN', 'departure_id': 'Station:airport:BCN', 'departure_city_name': 'Барселона', 'departure_city_id': 'City:barcelona_es', 'departure_name': 'Барселона - Ель-Прат', 'departure_country_code': 'ES', 'departure_country_id': 'Country:ES', 'arrival_station_code': 'KRK', 'arrival_id': 'Station:airport:KRK', 'arrival_city_name': 'Краків', 'arrival_city_id': 'City:krakow_pl', 'arrival_name': 'Міжнародний аеропорт Краків - Баліце ім. Іоана Павла ІІ', 'arrival_country_code': 'PL', 'arrival_country_id': 'Country:PL', 'airline': 'Wizz Air', 'departure_local_time': datetime(2024, 12, 12, 19, 40), 'departure_utc_time': datetime(2024, 12, 12, 18, 40), 'arrival_local_time': datetime(2024, 12, 12, 22, 40), 'arrival_utc_time': datetime(2024, 12, 12, 21, 40), 'price': 38.0, 'price_eur': 34.264609, 'seats_left': 5}, {'departure_station_code': 'BCN', 'departure_id': 'Station:airport:BCN', 'departure_city_name': 'Барселона', 'departure_city_id': 'City:barcelona_es', 'departure_name': 'Барселона - Ель-Прат', 'departure_country_code': 'ES', 'departure_country_id': 'Country:ES', 'arrival_station_code': 'WMI', 'arrival_id': 'Station:airport:WMI', 'arrival_city_name': 'Варшава', 'arrival_city_id': 'City:warsaw_pl', 'arrival_name': 'Аеропорт Варшава-Модлін', 'arrival_country_code': 'PL', 'arrival_country_id': 'Country:PL', 'airline': 'Ryanair', 'departure_local_time': datetime(2024, 11, 29, 20, 35), 'departure_utc_time': datetime(2024, 11, 29, 19, 35), 'arrival_local_time': datetime(2024, 11, 29, 23, 40), 'arrival_utc_time': datetime(2024, 11, 29, 22, 40), 'price': 38.5858, 'price_eur': 34.7928, 'seats_left': 3}, {'departure_station_code': 'BCN', 'departure_id': 'Station:airport:BCN', 'departure_city_name': 'Барселона', 'departure_city_id': 'City:barcelona_es', 'departure_name': 'Барселона - Ель-Прат', 'departure_country_code': 'ES', 'departure_country_id': 'Country:ES', 'arrival_station_code': 'KRK', 'arrival_id': 'Station:airport:KRK', 'arrival_city_name': 'Краків', 'arrival_city_id': 'City:krakow_pl', 'arrival_name': 'Міжнародний аеропорт Краків - Баліце ім. Іоана Павла ІІ', 'arrival_country_code': 'PL', 'arrival_country_id': 'Country:PL', 'airline': 'Ryanair', 'departure_local_time': datetime(2024, 12, 10, 14, 5), 'departure_utc_time': datetime(2024, 12, 10, 13, 5), 'arrival_local_time': datetime(2024, 12, 10, 16, 55), 'arrival_utc_time': datetime(2024, 12, 10, 15, 55), 'price': 39.3823, 'price_eur': 35.511, 'seats_left': None}, {'departure_station_code': 'BCN', 'departure_id': 'Station:airport:BCN', 'departure_city_name': 'Барселона', 'departure_city_id': 'City:barcelona_es', 'departure_name': 'Барселона - Ель-Прат', 'departure_country_code': 'ES', 'departure_country_id': 'Country:ES', 'arrival_station_code': 'KRK', 'arrival_id': 'Station:airport:KRK', 'arrival_city_name': 'Краків', 'arrival_city_id': 'City:krakow_pl', 'arrival_name': 'Міжнародний аеропорт Краків - Баліце ім. Іоана Павла ІІ', 'arrival_country_code': 'PL', 'arrival_country_id': 'Country:PL', 'airline': 'Ryanair', 'departure_local_time': datetime(2024, 12, 8, 9, 45), 'departure_utc_time': datetime(2024, 12, 8, 8, 45), 'arrival_local_time': datetime(2024, 12, 8, 12, 35), 'arrival_utc_time': datetime(2024, 12, 8, 11, 35), 'price': 39.3823, 'price_eur': 35.511, 'seats_left': 4}, {'departure_station_code': 'BCN', 'departure_id': 'Station:airport:BCN', 'departure_city_name': 'Барселона', 'departure_city_id': 'City:barcelona_es', 'departure_name': 'Барселона - Ель-Прат', 'departure_country_code': 'ES', 'departure_country_id': 'Country:ES', 'arrival_station_code': 'KRK', 'arrival_id': 'Station:airport:KRK', 'arrival_city_name': 'Краків', 'arrival_city_id': 'City:krakow_pl', 'arrival_name': 'Міжнародний аеропорт Краків - Баліце ім. Іоана Павла ІІ', 'arrival_country_code': 'PL', 'arrival_country_id': 'Country:PL', 'airline': 'Ryanair', 'departure_local_time': datetime(2024, 12, 19, 18, 15), 'departure_utc_time': datetime(2024, 12, 19, 17, 15), 'arrival_local_time': datetime(2024, 12, 19, 21, 5), 'arrival_utc_time': datetime(2024, 12, 19, 20, 5), 'price': 39.8501, 'price_eur': 35.9328, 'seats_left': 3}, {'departure_station_code': 'BCN', 'departure_id': 'Station:airport:BCN', 'departure_city_name': 'Барселона', 'departure_city_id': 'City:barcelona_es', 'departure_name': 'Барселона - Ель-Прат', 'departure_country_code': 'ES', 'departure_country_id': 'Country:ES', 'arrival_station_code': 'KRK', 'arrival_id': 'Station:airport:KRK', 'arrival_city_name': 'Краків', 'arrival_city_id': 'City:krakow_pl', 'arrival_name': 'Міжнародний аеропорт Краків - Баліце ім. Іоана Павла ІІ', 'arrival_country_code': 'PL', 'arrival_country_id': 'Country:PL', 'airline': 'Ryanair', 'departure_local_time': datetime(2024, 12, 16, 7, 50), 'departure_utc_time': datetime(2024, 12, 16, 6, 50), 'arrival_local_time': datetime(2024, 12, 16, 10, 40), 'arrival_utc_time': datetime(2024, 12, 16, 9, 40), 'price': 39.8501, 'price_eur': 35.9328, 'seats_left': 2}, {'departure_station_code': 'MAD', 'departure_id': 'Station:airport:MAD', 'departure_city_name': 'Мадрид', 'departure_city_id': 'City:madrid_es', 'departure_name': 'Аеропорт Мадрид-Барахас', 'departure_country_code': 'ES', 'departure_country_id': 'Country:ES', 'arrival_station_code': 'WMI', 'arrival_id': 'Station:airport:WMI', 'arrival_city_name': 'Варшава', 'arrival_city_id': 'City:warsaw_pl', 'arrival_name': 'Аеропорт Варшава-Модлін', 'arrival_country_code': 'PL', 'arrival_country_id': 'Country:PL', 'airline': 'Ryanair', 'departure_local_time': datetime(2024, 11, 24, 20, 15), 'departure_utc_time': datetime(2024, 11, 24, 19, 15), 'arrival_local_time': datetime(2024, 11, 24, 23, 45), 'arrival_utc_time': datetime(2024, 11, 24, 22, 45), 'price': 39.9385, 'price_eur': 36.0126, 'seats_left': 5}, {'departure_station_code': 'BCN', 'departure_id': 'Station:airport:BCN', 'departure_city_name': 'Барселона', 'departure_city_id': 'City:barcelona_es', 'departure_name': 'Барселона - Ель-Прат', 'departure_country_code': 'ES', 'departure_country_id': 'Country:ES', 'arrival_station_code': 'KRK', 'arrival_id': 'Station:airport:KRK', 'arrival_city_name': 'Краків', 'arrival_city_id': 'City:krakow_pl', 'arrival_name': 'Міжнародний аеропорт Краків - Баліце ім. Іоана Павла ІІ', 'arrival_country_code': 'PL', 'arrival_country_id': 'Country:PL', 'airline': 'Ryanair', 'departure_local_time': datetime(2024, 11, 7, 9, 30), 'departure_utc_time': datetime(2024, 11, 7, 8, 30), 'arrival_local_time': datetime(2024, 11, 7, 12, 20), 'arrival_utc_time': datetime(2024, 11, 7, 11, 20), 'price': 40.4443, 'price_eur': 36.4686, 'seats_left': None}, {'departure_station_code': 'BCN', 'departure_id': 'Station:airport:BCN', 'departure_city_name': 'Барселона', 'departure_city_id': 'City:barcelona_es', 'departure_name': 'Барселона - Ель-Прат', 'departure_country_code': 'ES', 'departure_country_id': 'Country:ES', 'arrival_station_code': 'KRK', 'arrival_id': 'Station:airport:KRK', 'arrival_city_name': 'Краків', 'arrival_city_id': 'City:krakow_pl', 'arrival_name': 'Міжнародний аеропорт Краків - Баліце ім. Іоана Павла ІІ', 'arrival_country_code': 'PL', 'arrival_country_id': 'Country:PL', 'airline': 'Ryanair', 'departure_local_time': datetime(2024, 11, 16, 9, 30), 'departure_utc_time': datetime(2024, 11, 16, 8, 30), 'arrival_local_time': datetime(2024, 11, 16, 12, 20), 'arrival_utc_time': datetime(2024, 11, 16, 11, 20), 'price': 41.1523, 'price_eur': 37.107, 'seats_left': 4}, {'departure_station_code': 'BCN', 'departure_id': 'Station:airport:BCN', 'departure_city_name': 'Барселона', 'departure_city_id': 'City:barcelona_es', 'departure_name': 'Барселона - Ель-Прат', 'departure_country_code': 'ES', 'departure_country_id': 'Country:ES', 'arrival_station_code': 'KRK', 'arrival_id': 'Station:airport:KRK', 'arrival_city_name': 'Краків', 'arrival_city_id': 'City:krakow_pl', 'arrival_name': 'Міжнародний аеропорт Краків - Баліце ім. Іоана Павла ІІ', 'arrival_country_code': 'PL', 'arrival_country_id': 'Country:PL', 'airline': 'Wizz Air', 'departure_local_time': datetime(2024, 12, 18, 9, 30), 'departure_utc_time': datetime(2024, 12, 18, 8, 30), 'arrival_local_time': datetime(2024, 12, 18, 12, 30), 'arrival_utc_time': datetime(2024, 12, 18, 11, 30), 'price': 43.0, 'price_eur': 38.77311, 'seats_left': 2}, {'departure_station_code': 'BCN', 'departure_id': 'Station:airport:BCN', 'departure_city_name': 'Барселона', 'departure_city_id': 'City:barcelona_es', 'departure_name': 'Барселона - Ель-Прат', 'departure_country_code': 'ES', 'departure_country_id': 'Country:ES', 'arrival_station_code': 'KRK', 'arrival_id': 'Station:airport:KRK', 'arrival_city_name': 'Краків', 'arrival_city_id': 'City:krakow_pl', 'arrival_name': 'Міжнародний аеропорт Краків - Баліце ім. Іоана Павла ІІ', 'arrival_country_code': 'PL', 'arrival_country_id': 'Country:PL', 'airline': 'Wizz Air', 'departure_local_time': datetime(2024, 11, 15, 9, 30), 'departure_utc_time': datetime(2024, 11, 15, 8, 30), 'arrival_local_time': datetime(2024, 11, 15, 12, 30), 'arrival_utc_time': datetime(2024, 11, 15, 11, 30), 'price': 43.0, 'price_eur': 38.77311, 'seats_left': 5}, {'departure_station_code': 'BCN', 'departure_id': 'Station:airport:BCN', 'departure_city_name': 'Барселона', 'departure_city_id': 'City:barcelona_es', 'departure_name': 'Барселона - Ель-Прат', 'departure_country_code': 'ES', 'departure_country_id': 'Country:ES', 'arrival_station_code': 'KRK', 'arrival_id': 'Station:airport:KRK', 'arrival_city_name': 'Краків', 'arrival_city_id': 'City:krakow_pl', 'arrival_name': 'Міжнародний аеропорт Краків - Баліце ім. Іоана Павла ІІ', 'arrival_country_code': 'PL', 'arrival_country_id': 'Country:PL', 'airline': 'Ryanair', 'departure_local_time': datetime(2024, 11, 23, 9, 30), 'departure_utc_time': datetime(2024, 11, 23, 8, 30), 'arrival_local_time': datetime(2024, 11, 23, 12, 20), 'arrival_utc_time': datetime(2024, 11, 23, 11, 20), 'price': 43.2762, 'price_eur': 39.0222, 'seats_left': 3}, {'departure_station_code': 'BCN', 'departure_id': 'Station:airport:BCN', 'departure_city_name': 'Барселона', 'departure_city_id': 'City:barcelona_es', 'departure_name': 'Барселона - Ель-Прат', 'departure_country_code': 'ES', 'departure_country_id': 'Country:ES', 'arrival_station_code': 'KRK', 'arrival_id': 'Station:airport:KRK', 'arrival_city_name': 'Краків', 'arrival_city_id': 'City:krakow_pl', 'arrival_name': 'Міжнародний аеропорт Краків - Баліце ім. Іоана Павла ІІ', 'arrival_country_code': 'PL', 'arrival_country_id': 'Country:PL', 'airline': 'Ryanair', 'departure_local_time': datetime(2024, 12, 19, 9, 30), 'departure_utc_time': datetime(2024, 12, 19, 8, 30), 'arrival_local_time': datetime(2024, 12, 19, 12, 20), 'arrival_utc_time': datetime(2024, 12, 19, 11, 20), 'price': 43.4785, 'price_eur': 39.2046, 'seats_left': 3}, {'departure_station_code': 'BCN', 'departure_id': 'Station:airport:BCN', 'departure_city_name': 'Барселона', 'departure_city_id': 'City:barcelona_es', 'departure_name': 'Барселона - Ель-Прат', 'departure_country_code': 'ES', 'departure_country_id': 'Country:ES', 'arrival_station_code': 'KRK', 'arrival_id': 'Station:airport:KRK', 'arrival_city_name': 'Краків', 'arrival_city_id': 'City:krakow_pl', 'arrival_name': 'Міжнародний аеропорт Краків - Баліце ім. Іоана Павла ІІ', 'arrival_country_code': 'PL', 'arrival_country_id': 'Country:PL', 'airline': 'Ryanair', 'departure_local_time': datetime(2024, 12, 18, 16, 20), 'departure_utc_time': datetime(2024, 12, 18, 15, 20), 'arrival_local_time': datetime(2024, 12, 18, 19, 10), 'arrival_utc_time': datetime(2024, 12, 18, 18, 10), 'price': 43.4785, 'price_eur': 39.2046, 'seats_left': None}, {'departure_station_code': 'MAD', 'departure_id': 'Station:airport:MAD', 'departure_city_name': 'Мадрид', 'departure_city_id': 'City:madrid_es', 'departure_name': 'Аеропорт Мадрид-Барахас', 'departure_country_code': 'ES', 'departure_country_id': 'Country:ES', 'arrival_station_code': 'WMI', 'arrival_id': 'Station:airport:WMI', 'arrival_city_name': 'Варшава', 'arrival_city_id': 'City:warsaw_pl', 'arrival_name': 'Аеропорт Варшава-Модлін', 'arrival_country_code': 'PL', 'arrival_country_id': 'Country:PL', 'airline': 'Ryanair', 'departure_local_time': datetime(2024, 12, 15, 20, 15), 'departure_utc_time': datetime(2024, 12, 15, 19, 15), 'arrival_local_time': datetime(2024, 12, 15, 23, 45), 'arrival_utc_time': datetime(2024, 12, 15, 22, 45), 'price': 43.4785, 'price_eur': 39.2046, 'seats_left': 5}, {'departure_station_code': 'BCN', 'departure_id': 'Station:airport:BCN', 'departure_city_name': 'Барселона', 'departure_city_id': 'City:barcelona_es', 'departure_name': 'Барселона - Ель-Прат', 'departure_country_code': 'ES', 'departure_country_id': 'Country:ES', 'arrival_station_code': 'KRK', 'arrival_id': 'Station:airport:KRK', 'arrival_city_name': 'Краків', 'arrival_city_id': 'City:krakow_pl', 'arrival_name': 'Міжнародний аеропорт Краків - Баліце ім. Іоана Павла ІІ', 'arrival_country_code': 'PL', 'arrival_country_id': 'Country:PL', 'airline': 'Ryanair', 'departure_local_time': datetime(2024, 12, 1, 9, 45), 'departure_utc_time': datetime(2024, 12, 1, 8, 45), 'arrival_local_time': datetime(2024, 12, 1, 12, 35), 'arrival_utc_time': datetime(2024, 12, 1, 11, 35), 'price': 44.2877, 'price_eur': 39.9342, 'seats_left': 2}, {'departure_station_code': 'BCN', 'departure_id': 'Station:airport:BCN', 'departure_city_name': 'Барселона', 'departure_city_id': 'City:barcelona_es', 'departure_name': 'Барселона - Ель-Прат', 'departure_country_code': 'ES', 'departure_country_id': 'Country:ES', 'arrival_station_code': 'KRK', 'arrival_id': 'Station:airport:KRK', 'arrival_city_name': 'Краків', 'arrival_city_id': 'City:krakow_pl', 'arrival_name': 'Міжнародний аеропорт Краків - Баліце ім. Іоана Павла ІІ', 'arrival_country_code': 'PL', 'arrival_country_id': 'Country:PL', 'airline': 'Ryanair', 'departure_local_time': datetime(2024, 12, 14, 9, 30), 'departure_utc_time': datetime(2024, 12, 14, 8, 30), 'arrival_local_time': datetime(2024, 12, 14, 12, 20), 'arrival_utc_time': datetime(2024, 12, 14, 11, 20), 'price': 44.2877, 'price_eur': 39.9342, 'seats_left': 1}, {'departure_station_code': 'MAD', 'departure_id': 'Station:airport:MAD', 'departure_city_name': 'Мадрид', 'departure_city_id': 'City:madrid_es', 'departure_name': 'Аеропорт Мадрид-Барахас', 'departure_country_code': 'ES', 'departure_country_id': 'Country:ES', 'arrival_station_code': 'WMI', 'arrival_id': 'Station:airport:WMI', 'arrival_city_name': 'Варшава', 'arrival_city_id': 'City:warsaw_pl', 'arrival_name': 'Аеропорт Варшава-Модлін', 'arrival_country_code': 'PL', 'arrival_country_id': 'Country:PL', 'airline': 'Ryanair', 'departure_local_time': datetime(2024, 11, 10, 20, 15), 'departure_utc_time': datetime(2024, 11, 10, 19, 15), 'arrival_local_time': datetime(2024, 11, 10, 23, 45), 'arrival_utc_time': datetime(2024, 11, 10, 22, 45), 'price': 44.2877, 'price_eur': 39.9342, 'seats_left': 3}, {'departure_station_code': 'BCN', 'departure_id': 'Station:airport:BCN', 'departure_city_name': 'Барселона', 'departure_city_id': 'City:barcelona_es', 'departure_name': 'Барселона - Ель-Прат', 'departure_country_code': 'ES', 'departure_country_id': 'Country:ES', 'arrival_station_code': 'KRK', 'arrival_id': 'Station:airport:KRK', 'arrival_city_name': 'Краків', 'arrival_city_id': 'City:krakow_pl', 'arrival_name': 'Міжнародний аеропорт Краків - Баліце ім. Іоана Павла ІІ', 'arrival_country_code': 'PL', 'arrival_country_id': 'Country:PL', 'airline': 'Ryanair', 'departure_local_time': datetime(2024, 11, 26, 14, 5), 'departure_utc_time': datetime(2024, 11, 26, 13, 5), 'arrival_local_time': datetime(2024, 11, 26, 16, 55), 'arrival_utc_time': datetime(2024, 11, 26, 15, 55), 'price': 44.3382, 'price_eur': 39.9798, 'seats_left': 4}, {'departure_station_code': 'BCN', 'departure_id': 'Station:airport:BCN', 'departure_city_name': 'Барселона', 'departure_city_id': 'City:barcelona_es', 'departure_name': 'Барселона - Ель-Прат', 'departure_country_code': 'ES', 'departure_country_id': 'Country:ES', 'arrival_station_code': 'KRK', 'arrival_id': 'Station:airport:KRK', 'arrival_city_name': 'Краків', 'arrival_city_id': 'City:krakow_pl', 'arrival_name': 'Міжнародний аеропорт Краків - Баліце ім. Іоана Павла ІІ', 'arrival_country_code': 'PL', 'arrival_country_id': 'Country:PL', 'airline': 'Ryanair', 'departure_local_time': datetime(2024, 12, 9, 7, 50), 'departure_utc_time': datetime(2024, 12, 9, 6, 50), 'arrival_local_time': datetime(2024, 12, 9, 10, 40), 'arrival_utc_time': datetime(2024, 12, 9, 9, 40), 'price': 45.4002, 'price_eur': 40.9374, 'seats_left': None}, {'departure_station_code': 'BCN', 'departure_id': 'Station:airport:BCN', 'departure_city_name': 'Барселона', 'departure_city_id': 'City:barcelona_es', 'departure_name': 'Барселона - Ель-Прат', 'departure_country_code': 'ES', 'departure_country_id': 'Country:ES', 'arrival_station_code': 'WMI', 'arrival_id': 'Station:airport:WMI', 'arrival_city_name': 'Варшава', 'arrival_city_id': 'City:warsaw_pl', 'arrival_name': 'Аеропорт Варшава-Модлін', 'arrival_country_code': 'PL', 'arrival_country_id': 'Country:PL', 'airline': 'Ryanair', 'departure_local_time': datetime(2024, 10, 30, 5, 45), 'departure_utc_time': datetime(2024, 10, 30, 4, 45), 'arrival_local_time': datetime(2024, 10, 30, 8, 50), 'arrival_utc_time': datetime(2024, 10, 30, 7, 50), 'price': 46.9932, 'price_eur': 42.3738, 'seats_left': 4}]
#     return flights1, flights2, flights3


def combine_flights(flights_lists, min_days_staying, max_days_staying):
    def is_valid_connection(previous_flight_to, next_flight_to):
        # Перевіряємо чи точка прибуття з першого рейсу співпадає з точкою відбуття другого рейсу
        if previous_flight_to['arrival_city_id'] != next_flight_to['departure_city_id']:
            return False

        # Перевіряємо чи час між рейсами становить від min_days_staying до max_days_staying днів
        days_between = (next_flight_to['departure_utc_time'] - previous_flight_to['arrival_utc_time']).days
        return min_days_staying <= days_between <= max_days_staying

    valid_routes = []

    # Створюємо всі можливі комбінації з усіх списків рейсів
    for flights_combo in product(*flights_lists):
        if all(is_valid_connection(flights_combo[i], flights_combo[i+1]) for i in range(len(flights_combo)-1)):
            total_price = sum(flight['price'] for flight in flights_combo)
            valid_routes.append({
                'route': flights_combo,
                'total_price': total_price
            })

    # Сортуємо маршрути за спаданням загальної вартості
    sorted_routes = sorted(valid_routes, key=lambda x: x['total_price'])

    return sorted_routes


async def main() -> None:
    flight_params_list = [
        (datetime.now(), datetime(2024, 12, 31),
         ['польща'],
         ['рим-італія', 'мілан-італія', 'ріміні-італія'],
         5, 'usd'),
        (datetime.now(), datetime(2024, 12, 31),
         ['рим-італія', 'мілан-італія', 'ріміні-італія'],
         ['барселона-іспанія', 'мадрид-іспанія'],
         5, 'usd'),
        (datetime.now(), datetime(2024, 12, 31),
         ['барселона-іспанія', 'мадрид-іспанія'],
         ['рим-італія', 'мілан-італія', 'ріміні-італія'],
         5, 'usd'),
        (datetime.now(), datetime(2024, 12, 31),
         ['рим-італія', 'мілан-італія', 'ріміні-італія'],
         ['варшава-польща', 'краків-польща', 'лодзь-польща'],
         5, 'usd'),
    ]
    flights = get_flights_list(flight_params_list)
    routes = combine_flights(flights, min_days_staying=2, max_days_staying=3)

    # print(routes)

    # Виводимо відсортовані маршрути
    for route in routes:
        print("Маршрут:")
        for flight in route['route']:
            print(
                f"{flight['departure_city_name']} -> {flight['arrival_city_name']} ({flight['departure_local_time']} - "
                f"{flight['arrival_local_time']}) Ціна: {flight['price']}")
        print(f"Загальна ціна: {route['total_price']}\n")


if __name__ == "__main__":
    asyncio.run(main())
